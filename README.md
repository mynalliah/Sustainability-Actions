# Sustainability Actions

A tiny full-stack app to track sustainability actions.

- **Backend:** Django + Django REST Framework (DRF) — persists actions to a local **JSON file**
- **Frontend:** React + Axios
- **Tests:** Django test runner (backend) & Jest/RTL (frontend)
- **Postman:** Collection + environment for manual API testing

---

## Prerequisites

- **Python** 3.10+
- **Node.js** 18+ and **npm**
- (Optional) **Postman** desktop app

> Tip: keep the backend and frontend running in **two terminals**.

---

## Setup & Run

### Backend (Django + DRF)

```bash
# from repo root
cd backend

# create & activate virtualenv
python -m venv .venv
# macOS/Linux:
source .venv/bin/activate
# Windows (PowerShell):
# .venv\Scripts\Activate.ps1

# install dependencies
pip install -r requirements.txt
# (if requirements.txt is missing)
# pip install django djangorestframework django-cors-headers

# set up Django internal tables
python manage.py migrate

# start the server
python manage.py runserver 8000
# → http://127.0.0.1:8000
```
> Data storage
Actions are saved in backend/actions/data.json (auto-created as []).
To reset app data, stop the server and delete that file.


### Frontend
```bash

# open a second terminal
cd frontend

# install dependencies
npm install

# point the UI at your backend
echo "REACT_APP_API_BASE=http://127.0.0.1:8000" > .env.local

# start the app
npm start
# → http://localhost:3000
```
> If you change the backend host/port later, update .env.local and restart npm start.


### API Endpoints
```bash
BASE URL: http://127.0.0.01:8000

| Method | Path                 | Description                |
| -----: | -------------------- | -------------------------- |
|    GET | `/api/actions/`      | List all actions           |
|   POST | `/api/actions/`      | Create an action           |
|    GET | `/api/actions/<id>/` | Retrieve one (convenience) |
|    PUT | `/api/actions/<id>/` | Full update                |
|  PATCH | `/api/actions/<id>/` | Partial update             |
| DELETE | `/api/actions/<id>/` | Delete                     |

Example Post body
{ "action": "Recycling", "date": "2025-01-08", "points": 25 }
```
Notes
- date must be YYYY-MM-DD
- points must be an integer >= 0
- id is generated by the server


### Running Tests
#### Backend Tests
```bash
cd backend
# (activate venv if not already)
python manage.py test
# expected output
OK
```
#### Frontend Tests
```bash
cd frontend
npm test
```
>Press a to run all tests, q to quit watch mode. 
```bash
CI/one-shot (no watch):
```

## Postman
1. Open the Postman desktop app.
2. Import:
    - postman/SustainabilityActions.postman_collection.json
    - (optional) postman/Local.postman_environment.json
3. Select the local environment (sets base_url = http://127.0.0.1:8000).
4. Run the requests top-to-bottom:
    - GET /api/actions/ → should be [] initially
    - POST /api/actions/ → creates an item and stores {{id}}
    - PUT / PATCH / DELETE / GET one → use {{id}} from the POST step

## Troubleshooting
- Frontend can’t reach backend: ensure backend is running on http://127.0.0.1:8000 and .env.local matches.
- CORS in browser: open the app at http://localhost:3000 (not 127.0.0.1:3000).
- Validation errors: date must be YYYY-MM-DD; points must be an integer (≥ 0).
